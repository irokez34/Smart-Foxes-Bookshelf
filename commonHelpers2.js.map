{"version":3,"file":"commonHelpers2.js","sources":["../src/js/reg_form.js"],"sourcesContent":["const elements = {\n  registrationForm: document.getElementById('registration_form'),\n  loginForm: document.getElementById('login_form'),\n  registrationName: document.getElementById('registration_name'),\n  registrationEmail: document.getElementById('registration_email'),\n  registrationPassword: document.getElementById('registration_password'),\n  closeModalButton: document.getElementById('closeModalButton'),\n  showRegistrationFormButton: document.getElementById(\n    'showRegistrationFormButton'\n  ),\n  showLoginFormButton: document.getElementById('showLoginFormButton'),\n  registerButton: document.getElementById('registerButton'),\n  loginButton: document.getElementById('loginButton'),\n  loginEmail: document.getElementById('login_email'),\n  loginPassword: document.getElementById('login_password'),\n  userDropdown: document.querySelector('.select-menu'),\n  signUpButton: document.querySelector('.header-link-log-up'),\n  mobileActiveAcc: document.querySelector('.mobile-active-acc'),\n  userInfoContainer: document.getElementById('user_info'),\n  userNameElement: document.querySelector('.user-name'),\n  googleSignInButton: document.getElementById('googleSignInButton'),\n  logoutButton: document.getElementById('logoutButton'),\n  usernameDisplay: document.querySelector('.user-name'),\n  toggleButtons: document.querySelectorAll('.toggle_buttons button'),\n};\nconst firebaseConfig = {\n  apiKey: 'AIzaSyAQpcHlYnmJgrkoX3KbdR3qCIHswCf3vaM',\n  authDomain: 'bookshelf-smartfoxes-team.firebaseapp.com',\n  projectId: 'bookshelf-smartfoxes-team',\n  storageBucket: 'bookshelf-smartfoxes-team.appspot.com',\n  messagingSenderId: '615845871184',\n  appId: '1:615845871184:web:f8e6e3da332e48b2721b55',\n  measurementId: 'G-J4EFJFQ0WD',\n};\nfirebase.initializeApp(firebaseConfig);\nconst auth = firebase.auth();\nconst database = firebase.database();\nfunction redirectToIndex() {\n  location.href = 'index.html';\n}\nfunction toggleFormVisibility(showForm, hideForm, clickedButton) {\n  elements[showForm].style.display = 'flex';\n  elements[hideForm].style.display = 'none';\n\n  elements.toggleButtons.forEach(button => {\n    button.classList.remove('clicked');\n  });\n\n  elements[clickedButton].classList.add('clicked');\n}\n\nfunction showRegistrationForm() {\n  toggleFormVisibility(\n    'registrationForm',\n    'loginForm',\n    'showRegistrationFormButton'\n  );\n}\n\nfunction showLoginForm() {\n  toggleFormVisibility('loginForm', 'registrationForm', 'showLoginFormButton');\n}\n\nfunction saveUserDataToLocalStorage(userData) {\n  localStorage.setItem('user_data', JSON.stringify(userData));\n}\n\nfunction getUserDataFromLocalStorage() {\n  const userDataString = localStorage.getItem('user_data');\n  return userDataString ? JSON.parse(userDataString) : null;\n}\n\nfunction closeModal() {\n  elements.registrationForm.style.display = 'none';\n  // redirectToIndex();\n}\n\nfunction register() {\n  let name = elements.registrationName.value;\n  let email = elements.registrationEmail.value;\n  let password = elements.registrationPassword.value;\n\n  if (\n    !validate_field(name) ||\n    !validate_email(email) ||\n    !validate_password(password)\n  ) {\n    alert('Registration failed. Please check your inputs.');\n    return;\n  }\n\n  auth\n    .createUserWithEmailAndPassword(email, password)\n    .then(userCredential => {\n      let user = userCredential.user;\n      let database_ref = database.ref();\n      let user_data = {\n        name: name,\n        email: email,\n        last_login: Date.now(),\n      };\n      database_ref.child('users/' + user.uid).set(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Registration successful!');\n      console.log('Name:', name);\n      console.log('Email:', email);\n      clearRegistrationForm();\n      redirectToIndex();\n    })\n    .catch(error => {\n      alert(`Registration failed: ${error.message}`);\n    });\n}\n\nfunction login() {\n  let email = elements.loginEmail.value;\n  let password = elements.loginPassword.value;\n\n  if (!validate_email(email) || !validate_password(password)) {\n    alert('Login failed. Please check your inputs.');\n    return;\n  }\n\n  auth\n    .signInWithEmailAndPassword(email, password)\n    .then(userCredential => {\n      let user = userCredential.user;\n      let database_ref = database.ref();\n      let user_data = {\n        last_login: Date.now(),\n      };\n      database_ref.child('users/' + user.uid).update(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Login successful!');\n      console.log('Email:', email);\n      displayUserInfo(user);\n      clearLoginForm();\n      redirectToIndex();\n    })\n    .catch(error => {\n      alert(`Login failed: ${error.message}`);\n    });\n}\n\nfunction validate_email(email) {\n  let expression = /^[^@]+@\\w+(\\.\\w+)+\\w$/;\n  return expression.test(email);\n}\n\nfunction validate_password(password) {\n  return password.length >= 6;\n}\n\nfunction validate_field(field) {\n  return field.trim() !== '';\n}\n\nfunction clearRegistrationForm() {\n  elements.registrationName.value = '';\n  elements.registrationEmail.value = '';\n  elements.registrationPassword.value = '';\n}\n\nfunction clearLoginForm() {\n  elements.loginEmail.value = '';\n  elements.loginPassword.value = '';\n}\n\nfunction displayUserInfo(user) {\n  if (elements.userInfoContainer && elements.userNameElement) {\n    elements.userInfoContainer.textContent = `Welcome, ${\n      user.displayName || user.email\n    }!`;\n    elements.userNameElement.textContent = user.displayName || user.email;\n  } else {\n    console.error(\n      \"Element with id 'user_info' or class 'user-name' not found.\"\n    );\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  elements.showRegistrationFormButton.addEventListener(\n    'click',\n    showRegistrationForm\n  );\n  elements.showLoginFormButton.addEventListener('click', showLoginForm);\n  elements.registerButton.addEventListener('click', register);\n  elements.loginButton.addEventListener('click', login);\n  elements.closeModalButton.addEventListener('click', closeModal);\n  elements.registrationForm.addEventListener('keydown', event => {\n    if (event.key === 'Enter') {\n      register();\n    }\n  });\n\n  elements.loginForm.addEventListener('keydown', event => {\n    if (event.key === 'Enter') {\n      login();\n    }\n  });\n\n  function loginWithGoogle() {\n    const provider = new firebase.auth.GoogleAuthProvider();\n\n    auth\n      .signInWithPopup(provider)\n      .then(result => {\n        const user = result.user;\n      })\n      .catch(error => {\n        console.error('Google login error:', error);\n      });\n  }\n  elements.googleSignInButton.addEventListener('click', loginWithGoogle);\n\n  function logout() {\n    localStorage.removeItem('user_data');\n    auth\n      .signOut()\n      .then(() => {\n        redirectToIndex();\n      })\n      .catch(error => {\n        console.error('Logout failed:', error);\n      });\n  }\n  elements.logoutButton.addEventListener('click', logout);\n});\n\nfunction updateUI(user) {\n  if (user) {\n    elements.usernameDisplay.textContent = user.displayName || user.email;\n\n    elements.userDropdown.classList.remove('is-hidden');\n    elements.signUpButton.style.display = 'none';\n    elements.mobileActiveAcc.classList.remove('is-hidden');\n  } else {\n    // localStorage.clear();\n    // window.location.href = \"../index.html\";\n  }\n}\n\nfirebase.auth().onAuthStateChanged(updateUI);\n"],"names":["elements","firebaseConfig","auth","database","redirectToIndex","toggleFormVisibility","showForm","hideForm","clickedButton","button","showRegistrationForm","showLoginForm","saveUserDataToLocalStorage","userData","closeModal","register","name","email","password","validate_field","validate_email","validate_password","userCredential","user","database_ref","user_data","clearRegistrationForm","error","login","displayUserInfo","clearLoginForm","field","event","loginWithGoogle","provider","result","logout","updateUI"],"mappings":"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"}
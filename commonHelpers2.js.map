{"version":3,"file":"commonHelpers2.js","sources":["../src/js/reg_form.js"],"sourcesContent":["// Конфігурація бази данних\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAQpcHlYnmJgrkoX3KbdR3qCIHswCf3vaM\",\n  authDomain: \"bookshelf-smartfoxes-team.firebaseapp.com\",\n  projectId: \"bookshelf-smartfoxes-team\",\n  storageBucket: \"bookshelf-smartfoxes-team.appspot.com\",\n  messagingSenderId: \"615845871184\",\n  appId: \"1:615845871184:web:f8e6e3da332e48b2721b55\",\n  measurementId: \"G-J4EFJFQ0WD\"\n};\nfirebase.initializeApp(firebaseConfig);\nconst auth = firebase.auth();\nconst database = firebase.database();\n\n// Function to save user data to local storage\nfunction saveUserDataToLocalStorage(userData) {\n  localStorage.setItem('user_data', JSON.stringify(userData));\n}\n\n// Function to retrieve user data from local storage\nfunction getUserDataFromLocalStorage() {\n  const userDataString = localStorage.getItem('user_data');\n  return userDataString ? JSON.parse(userDataString) : null;\n}\n\n// Функція для закриття модального вікна\nfunction closeModal() {\n  document.getElementById('myModal').style.display = 'none';\n  document.location.href = \"./index.html\";\n}\n\n// Функція для показу форми реєстрації\nfunction showRegistrationForm() {\n  document.getElementById(\"registration_form\").style.display = \"flex\";\n  document.getElementById(\"login_form\").style.display = \"none\";\n}\n\n// Функція для показу форми входу\nfunction showLoginForm() {\n  document.getElementById(\"registration_form\").style.display = \"none\";\n  document.getElementById(\"login_form\").style.display = \"flex\";\n}\n\n// Функція для реєстрації\nfunction register() {\n  let name = document.getElementById('registration_name').value;\n  let email = document.getElementById('registration_email').value;\n  let password = document.getElementById('registration_password').value;\n\n  if (!validate_field(name) || !validate_email(email) || !validate_password(password)) {\n    alert('Registration failed. Please check your inputs.');\n    return;\n  }\n\n  auth.createUserWithEmailAndPassword(email, password)\n    .then(() => {\n      let user = auth.currentUser;\n      let database_ref = database.ref();\n      let user_data = {\n        name: name,\n        email: email,\n        last_login: Date.now()\n      };\n      database_ref.child('users/' + user.uid).set(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Registration successful!');\n      clearRegistrationForm();\n      document.location.href = \"./index.html\";\n    })\n    .catch((error) => {\n      alert(`Registration failed: ${error.message}`);\n    });\n}\n\n// Функція для входу\nfunction login() {\n  let email = document.getElementById('login_email').value;\n  let password = document.getElementById('login_password').value;\n\n  if (!validate_email(email) || !validate_password(password)) {\n    alert('Login failed. Please check your inputs.');\n    return;\n  }\n\n  auth.signInWithEmailAndPassword(email, password)\n    .then(() => {\n      let user = auth.currentUser;\n      let database_ref = database.ref();\n      let user_data = {\n        last_login: Date.now()\n      };\n      database_ref.child('users/' + user.uid).update(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Login successful!');\n      displayUserInfo(user);\n      clearLoginForm();\n      document.location.href = \"./index.html\";\n    })\n    .catch((error) => {\n      alert(`Login failed: ${error.message}`);\n    });\n}\n\n// Функції валідації\nfunction validate_email(email) {\n  let expression = /^[^@]+@\\w+(\\.\\w+)+\\w$/;\n  return expression.test(email);\n}\n\nfunction validate_password(password) {\n  return password.length >= 6;\n}\n\nfunction validate_field(field) {\n  return field.trim() !== '';\n}\n\n// Функція для очищення полів форми реєстрації\nfunction clearRegistrationForm() {\n  document.getElementById('registration_name').value = '';\n  document.getElementById('registration_email').value = '';\n  document.getElementById('registration_password').value = '';\n}\n\n// Функція для очищення полів форми входу\nfunction clearLoginForm() {\n  document.getElementById('login_email').value = '';\n  document.getElementById('login_password').value = '';\n}\n\n// Функція для виведення імені користувача\nfunction displayUserInfo(user) {\n  const userInfoContainer = document.getElementById('user_info');\n  const userNameElement = document.querySelector('.user-name');\n\n  if (userInfoContainer && userNameElement) {\n    userInfoContainer.textContent = `Welcome, ${user.displayName || user.email}!`;\n    userNameElement.textContent = user.displayName || user.email;\n  } else {\n    console.error(\"Element with id 'user_info' or class 'user-name' not found.\");\n  }\n}\n\n// Додавання слухача подій до елементів\ndocument.addEventListener('DOMContentLoaded', () => {\n  document.getElementById('closeModalButton').addEventListener('click', closeModal);\n  document.getElementById('showRegistrationFormButton').addEventListener('click', showRegistrationForm);\n  document.getElementById('showLoginFormButton').addEventListener('click', showLoginForm);\n  document.getElementById('registerButton').addEventListener('click', register);\n  document.getElementById('loginButton').addEventListener('click', login);\n\n  // keydown для реєстрації по клавіші Enter\n  document.getElementById('registration_form').addEventListener('keydown', (event) => {\n    if (event.key === 'Enter') {\n      register();\n    }\n  });\n\n  // keydown для входу по клавіші Enter\n  document.getElementById('login_form').addEventListener('keydown', (event) => {\n    if (event.key === 'Enter') {\n      login();\n    }\n  });\n\n  // Логін з гугла\n  function loginWithGoogle() {\n    const provider = new firebase.auth.GoogleAuthProvider();\n\n    auth.signInWithPopup(provider)\n      .then((result) => {\n        const user = result.user;\n      })\n      .catch((error) => {\n        console.error('Помилка входу через Google:', error);\n      });\n  }\n  document.getElementById('googleSignInButton').addEventListener('click', loginWithGoogle);\n  \n\n  // Функція логаут\n  function logout() {\n    localStorage.removeItem('user_data');\n    auth.signOut()\n      .then(() => {\n        document.location.href = \"/\";\n      })\n      .catch((error) => {\n        console.error('Logout failed:', error);\n      });\n  }\n  document.getElementById('logoutButton').addEventListener('click', logout);\n});\n"],"names":["firebaseConfig","auth","database","saveUserDataToLocalStorage","userData","closeModal","showRegistrationForm","showLoginForm","register","name","email","password","validate_field","validate_email","validate_password","user","database_ref","user_data","clearRegistrationForm","error","login","displayUserInfo","clearLoginForm","field","userInfoContainer","userNameElement","event","loginWithGoogle","provider","result","logout"],"mappings":"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"}
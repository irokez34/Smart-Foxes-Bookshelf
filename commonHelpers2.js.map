{"version":3,"file":"commonHelpers2.js","sources":["../src/js/reg_form.js"],"sourcesContent":["const elements = {\n  registrationForm: document.getElementById('registration_form'),\n  loginForm: document.getElementById('login_form'),\n  registrationName: document.getElementById('registration_name'),\n  registrationEmail: document.getElementById('registration_email'),\n  registrationPassword: document.getElementById('registration_password'),\n  closeModalButton: document.getElementById('closeModalButton'),\n  showRegistrationFormButton: document.getElementById(\n    'showRegistrationFormButton'\n  ),\n  showLoginFormButton: document.getElementById('showLoginFormButton'),\n  registerButton: document.getElementById('registerButton'),\n  loginButton: document.getElementById('loginButton'),\n  loginEmail: document.getElementById('login_email'),\n  loginPassword: document.getElementById('login_password'),\n  userDropdown: document.querySelector('.select-menu'),\n  signUpButton: document.querySelector('.header-link-log-up'),\n  mobileActiveAcc: document.querySelector('.mobile-active-acc'),\n  userInfoContainer: document.getElementById('user_info'),\n  userNameElement: document.querySelector('.user-name'),\n  googleSignInButton: document.getElementById('googleSignInButton'),\n  logoutButton: document.getElementById('logoutButton'),\n  usernameDisplay: document.querySelector('.user-name'),\n};\n\nconst firebaseConfig = {\n  apiKey: 'AIzaSyAQpcHlYnmJgrkoX3KbdR3qCIHswCf3vaM',\n  authDomain: 'bookshelf-smartfoxes-team.firebaseapp.com',\n  projectId: 'bookshelf-smartfoxes-team',\n  storageBucket: 'bookshelf-smartfoxes-team.appspot.com',\n  messagingSenderId: '615845871184',\n  appId: '1:615845871184:web:f8e6e3da332e48b2721b55',\n  measurementId: 'G-J4EFJFQ0WD',\n};\nfirebase.initializeApp(firebaseConfig);\nconst auth = firebase.auth();\nconst database = firebase.database();\n\nfunction saveUserDataToLocalStorage(userData) {\n  localStorage.setItem('user_data', JSON.stringify(userData));\n}\n\nfunction getUserDataFromLocalStorage() {\n  const userDataString = localStorage.getItem('user_data');\n  return userDataString ? JSON.parse(userDataString) : null;\n}\n\nfunction closeModal() {\n  elements.registrationForm.style.display = 'none';\n  location.href = 'index.html';\n}\nfunction toggleFormVisibility(showForm, hideForm) {\n  elements[showForm].style.display = 'flex';\n  elements[hideForm].style.display = 'none';\n}\nfunction showRegistrationForm() {\n  toggleFormVisibility('registrationForm', 'loginForm');\n}\n\nfunction showLoginForm() {\n  toggleFormVisibility('loginForm', 'registrationForm');\n}\n\nfunction register() {\n  let name = elements.registrationName.value;\n  let email = elements.registrationEmail.value;\n  let password = elements.registrationPassword.value;\n\n  if (\n    !validate_field(name) ||\n    !validate_email(email) ||\n    !validate_password(password)\n  ) {\n    alert('Registration failed. Please check your inputs.');\n    return;\n  }\n\n  auth\n    .createUserWithEmailAndPassword(email, password)\n    .then(userCredential => {\n      let user = userCredential.user;\n      let database_ref = database.ref();\n      let user_data = {\n        name: name,\n        email: email,\n        last_login: Date.now(),\n      };\n      database_ref.child('users/' + user.uid).set(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Registration successful!');\n      console.log('Name:', name);\n      console.log('Email:', email);\n      clearRegistrationForm();\n      location.href = 'index.html';\n    })\n    .catch(error => {\n      alert(`Registration failed: ${error.message}`);\n    });\n}\n\nfunction login() {\n  let email = elements.loginEmail.value;\n  let password = elements.loginPassword.value;\n\n  if (!validate_email(email) || !validate_password(password)) {\n    alert('Login failed. Please check your inputs.');\n    return;\n  }\n\n  auth\n    .signInWithEmailAndPassword(email, password)\n    .then(userCredential => {\n      let user = userCredential.user;\n      let database_ref = database.ref();\n      let user_data = {\n        last_login: Date.now(),\n      };\n      database_ref.child('users/' + user.uid).update(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Login successful!');\n      console.log('Email:', email);\n      displayUserInfo(user);\n      clearLoginForm();\n      location.href = 'index.html';\n    })\n    .catch(error => {\n      alert(`Login failed: ${error.message}`);\n    });\n}\n\nfunction validate_email(email) {\n  let expression = /^[^@]+@\\w+(\\.\\w+)+\\w$/;\n  return expression.test(email);\n}\n\nfunction validate_password(password) {\n  return password.length >= 6;\n}\n\nfunction validate_field(field) {\n  return field.trim() !== '';\n}\n\nfunction clearRegistrationForm() {\n  elements.registrationName.value = '';\n  elements.registrationEmail.value = '';\n  elements.registrationPassword.value = '';\n}\n\nfunction clearLoginForm() {\n  elements.loginEmail.value = '';\n  elements.loginPassword.value = '';\n}\n\nfunction displayUserInfo(user) {\n  if (elements.userInfoContainer && elements.userNameElement) {\n    elements.userInfoContainer.textContent = `Welcome, ${\n      user.displayName || user.email\n    }!`;\n    elements.userNameElement.textContent = user.displayName || user.email;\n  } else {\n    console.error(\n      \"Element with id 'user_info' or class 'user-name' not found.\"\n    );\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  elements.closeModalButton.addEventListener('click', closeModal);\n  elements.showRegistrationFormButton.addEventListener(\n    'click',\n    showRegistrationForm\n  );\n  elements.showLoginFormButton.addEventListener('click', showLoginForm);\n  elements.registerButton.addEventListener('click', register);\n  elements.loginButton.addEventListener('click', login);\n\n  elements.registrationForm.addEventListener('keydown', event => {\n    if (event.key === 'Enter') {\n      register();\n    }\n  });\n\n  elements.loginForm.addEventListener('keydown', event => {\n    if (event.key === 'Enter') {\n      login();\n    }\n  });\n\n  function loginWithGoogle() {\n    const provider = new firebase.auth.GoogleAuthProvider();\n\n    auth\n      .signInWithPopup(provider)\n      .then(result => {\n        const user = result.user;\n      })\n      .catch(error => {\n        console.error('Google login error:', error);\n      });\n  }\n  elements.googleSignInButton.addEventListener('click', loginWithGoogle);\n\n  function logout() {\n    localStorage.removeItem('user_data');\n    auth\n      .signOut()\n      .then(() => {\n        location.href = 'index.html';\n      })\n      .catch(error => {\n        console.error('Logout failed:', error);\n      });\n  }\n  elements.logoutButton.addEventListener('click', logout);\n});\nfunction updateUI(user) {\n  if (user) {\n    elements.usernameDisplay.textContent = user.displayName || user.email;\n\n    elements.userDropdown.classList.remove('is-hidden');\n    elements.signUpButton.style.display = 'none';\n    elements.mobileActiveAcc.classList.remove('is-hidden');\n  } else {\n    // localStorage.clear();\n    // window.location.href = \"../index.html\";\n  }\n}\nfirebase.auth().onAuthStateChanged(updateUI);\n"],"names":["elements","firebaseConfig","auth","database","saveUserDataToLocalStorage","userData","closeModal","toggleFormVisibility","showForm","hideForm","showRegistrationForm","showLoginForm","register","name","email","password","validate_field","validate_email","validate_password","userCredential","user","database_ref","user_data","clearRegistrationForm","error","login","displayUserInfo","clearLoginForm","field","event","loginWithGoogle","provider","result","logout","updateUI"],"mappings":"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"}